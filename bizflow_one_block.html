<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BizFlow – One‑Block HTML (Repo completo + Instrucciones)</title>
  <style>
    :root { --bg:#0f172a; --card:#0b1221; --fg:#e5e7eb; --muted:#9ca3af; --accent:#22d3ee; --ok:#34d399; --warn:#f59e0b; }
    html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial,"Noto Sans",sans-serif;}
    .wrap{max-width:1000px;margin:0 auto;padding:28px}
    .title{font-size:28px;font-weight:800;margin:0 0 4px}
    .sub{color:var(--muted);margin:0 0 24px}
    .card{background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:18px 18px;margin:14px 0;box-shadow:0 6px 24px rgba(0,0,0,.3)}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .btn{display:inline-block;padding:10px 14px;border-radius:999px;border:1px solid rgba(255,255,255,.15);color:var(--fg);text-decoration:none}
    .btn:hover{background:rgba(255,255,255,.05)}
    code,pre{font-family: ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;font-size:13px;}
    pre{background:#020617;color:#e2e8f0;border:1px solid rgba(255,255,255,.08);padding:14px;border-radius:12px;overflow:auto}
    h2{font-size:20px;margin:10px 0}
    h3{font-size:16px;margin:8px 0;color:var(--accent)}
    .pill{display:inline-block;padding:2px 8px;border-radius:999px;background:rgba(34,211,238,.15);border:1px solid rgba(34,211,238,.35);color:#99f6e4;font-size:12px;margin-right:6px}
    details{border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:10px 12px;background:rgba(255,255,255,.03)}
    summary{cursor:pointer;font-weight:600}
    .ok{color:var(--ok)} .warn{color:var(--warn)}
    .kbd{border:1px solid rgba(255,255,255,.2);padding:2px 6px;border-radius:6px;background:rgba(255,255,255,.06)}
  </style>
</head>
<body>
  <div class="wrap">
    <h1 class="title">BizFlow – One‑Block HTML</h1>
    <p class="sub">Un solo archivo HTML con <strong>todo</strong>: instrucciones, scripts y workflows para crear el monorepo (Next.js + Express + Prisma), Docker y GitHub Actions, incluido el deploy a GitHub Pages bajo <span class="kbd">/bizflow</span>.</p>

    <div class="card">
      <div class="row">
        <span class="pill">Stack: Next.js + Tailwind</span>
        <span class="pill">API: Express + Prisma (PostgreSQL)</span>
        <span class="pill">CI/CD: GitHub Actions</span>
        <span class="pill">Pages: Export estático</span>
      </div>
      <p>Usuario sugerido: <code>eliezelapolinaris2017-lab</code> · Repo: <code>bizflow</code></p>
    </div>

    <div class="card">
      <h2>1) Pasos rápidos</h2>
      <ol>
        <li>Crea una carpeta vacía y copia el script del siguiente bloque en un archivo llamado <code>bootstrap_bizflow.sh</code>.</li>
        <li>Ejecuta: <code>chmod +x bootstrap_bizflow.sh &amp;&amp; ./bootstrap_bizflow.sh</code>.</li>
        <li>Edita <code>.env</code> con tu <em>DATABASE_URL</em> si usarás PostgreSQL local (o comenta la DB si no la usarás aún).</li>
        <li>Levanta en local: <code>pnpm dev</code>. API en <code>http://localhost:4000</code>, Web en <code>http://localhost:3000</code>.</li>
        <li>Activa GitHub Pages → Settings → Pages → GitHub Actions (si usas <code>pages.yml</code>).</li>
      </ol>
    </div>

    <div class="card">
      <h2>2) BLOQUE ÚNICO – Script Bootstrap (crea TODO el repo)</h2>
      <p>Personaliza variables <code>GITHUB_USER</code>, <code>REPO_NAME</code>, <code>CREATE_REMOTE</code>. El script genera: estructura, Next, API, Prisma, Docker, Actions, plantillas y README.</p>
      <pre><code>#!/usr/bin/env bash
set -euo pipefail

# ================================
# BizFlow: Bootstrap monorepo + CI/CD + Docker + Next + Express + Prisma
# ================================

# --- Configuración editable ---
GITHUB_USER="eliezelapolinaris2017-lab"   # tu usuario de GitHub
REPO_NAME="bizflow"                       # nombre del repo
CREATE_REMOTE="false"                     # "true" para crear repo con gh cli
PUBLISH_PAGES="true"                      # configurar workflow de Pages
INIT_GIT="true"                           # inicializar git
DEFAULT_BRANCH="main"

# --- Requisitos mínimos ---
command -v node &gt;/dev/null || { echo "[ERR] Node no está instalado"; exit 1; }
if ! command -v pnpm &gt;/dev/null; then
  echo "[INFO] Activando pnpm con corepack..."
  command -v corepack &gt;/dev/null || { echo "[ERR] corepack no disponible (Node 18+)"; exit 1; }
  corepack enable
fi

mkdir -p ${REPO_NAME}
cd ${REPO_NAME}

# README
cat &gt; README.md &lt;&lt;'MD'
# BizFlow (SaaS Mini-ERP Modular)

Monorepo con:
- **Web**: Next.js + Tailwind (export estático)
- **API**: Express + Prisma (PostgreSQL)
- **CI/CD**: GitHub Actions (build, Pages, Docker)
- **Contenedores**: Docker + Compose

## Puesta en marcha
```bash
corepack enable &amp;&amp; pnpm i
# DB (Docker opcional)
docker compose -f infra/docker/docker-compose.dev.yml up -d db || true
# Prisma
pnpm --filter apps/api prisma:generate
pnpm --filter apps/api prisma:migrate
# Dev
pnpm dev
```
MD

# Editorconfig
cat &gt; .editorconfig &lt;&lt;'EC'
root = true
[*]
charset = utf-8
end_of_line = lf
indent_style = space
indent_size = 2
insert_final_newline = true
trim_trailing_whitespace = true
EC

# Gitignore
cat &gt; .gitignore &lt;&lt;'GI'
node_modules
.next
out
dist
coverage
.env
.env.*
.prisma
.DS_Store
postgres-data
GI

# Licencia
cat &gt; LICENSE &lt;&lt;'LIC'
MIT License

Copyright (c) 2025

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to do so, subject to the
following conditions:

[Coloca aquí el texto MIT completo si lo deseas]
LIC

# Workspace
cat &gt; pnpm-workspace.yaml &lt;&lt;'YAML'
packages:
  - 'apps/*'
  - 'packages/*'
  - 'infra/*'
YAML

# package.json raíz
cat &gt; package.json &lt;&lt;'PKG'
{
  "name": "bizflow",
  "private": true,
  "version": "0.1.0",
  "scripts": {
    "dev:api": "pnpm --filter apps/api dev",
    "dev:web": "pnpm --filter apps/web dev",
    "dev": "concurrently -k \"pnpm dev:api\" \"pnpm dev:web\"",
    "build": "pnpm -r build",
    "start": "pnpm --filter apps/api start",
    "lint": "eslint ."
  },
  "devDependencies": {
    "concurrently": "^8.2.2",
    "eslint": "^9.0.0"
  }
}
PKG

# ESLint
cat &gt; .eslintrc.json &lt;&lt;'ESL'
{
  "root": true,
  "env": { "es2021": true, "node": true, "browser": true },
  "extends": ["eslint:recommended"],
  "parserOptions": { "ecmaVersion": 2021, "sourceType": "module" },
  "ignorePatterns": ["dist", "node_modules"],
  "rules": { "no-unused-vars": ["warn", { "argsIgnorePattern": "^_" }] }
}
ESL

# CODEOWNERS &amp; SECURITY
cat &gt; CODEOWNERS &lt;&lt;CO
*       @"$GITHUB_USER"
/apps/api/ @"$GITHUB_USER"
/apps/web/ @"$GITHUB_USER"
CO

cat &gt; SECURITY.md &lt;&lt;'SEC'
# Política de seguridad
Si encuentras vulnerabilidades, contacta: security@ejemplo.com
No publiques PoCs en issues públicos sin coordinación previa.
SEC

# Issue / PR templates
mkdir -p .github/ISSUE_TEMPLATE .github/workflows
cat &gt; .github/ISSUE_TEMPLATE/bug_report.md &lt;&lt;'BR'
---
name: Bug Report
about: Reporta un error
labels: bug
---

**Describe el bug**
...

**Repro pasos**
1. ...

**Comportamiento esperado**
...

**Logs / Capturas**
...
BR

cat &gt; .github/ISSUE_TEMPLATE/feature_request.md &lt;&lt;'FR'
---
name: Feature Request
about: Propón una nueva funcionalidad
labels: enhancement
---

**Problema a resolver**
...

**Propuesta**
...

**Criterios de aceptación**
- [ ] ...
FR

cat &gt; .github/PULL_REQUEST_TEMPLATE.md &lt;&lt;'PR'
## Descripción
...

## Tipo
- [ ] Feature
- [ ] Fix
- [ ] Refactor

## Checklist
- [ ] Tests agregados/actualizados
- [ ] Linter ok
- [ ] Docs/README actualizados
PR

# ================= WEB (Next.js + Tailwind) =================
mkdir -p apps
pnpm dlx create-next-app apps/web --ts --eslint --src-dir --app --tailwind --import-alias "@/*" -y

# Config para GitHub Pages (/bizflow)
cat &gt; apps/web/next.config.js &lt;&lt;'NX'
/** @type {import('next').NextConfig} */
const isProd = process.env.NODE_ENV === 'production';
module.exports = {
  output: 'export',
  basePath: isProd ? '/bizflow' : '',
  assetPrefix: isProd ? '/bizflow/' : '',
  images: { unoptimized: true }
};
NX

# Home dashboard simple
cat &gt; apps/web/app/page.tsx &lt;&lt;'PAGE'
export default function Home() {
  return (
    <main className="min-h-screen bg-gray-50 p-6">
      <div className="mx-auto max-w-6xl">
        <header className="mb-8 flex items-center justify-between">
          <h1 className="text-2xl font-bold">BizFlow Dashboard</h1>
          <div className="text-sm text-gray-600">MVP v0.1.0</div>
        </header>
        <section className="grid gap-6 md:grid-cols-3">
          <div className="rounded-2xl bg-white p-5 shadow">
            <h2 className="mb-2 text-sm font-semibold text-gray-500">Ingresos (mes)</h2>
            <p className="text-3xl font-bold">$12,450</p>
          </div>
          <div className="rounded-2xl bg-white p-5 shadow">
            <h2 className="mb-2 text-sm font-semibold text-gray-500">Gastos (mes)</h2>
            <p className="text-3xl font-bold">$7,820</p>
          </div>
          <div className="rounded-2xl bg-white p-5 shadow">
            <h2 className="mb-2 text-sm font-semibold text-gray-500">Clientes activos</h2>
            <p className="text-3xl font-bold">83</p>
          </div>
        </section>
        <section className="mt-8 rounded-2xl bg-white p-6 shadow">
          <h3 className="mb-4 text-lg font-semibold">Acciones rápidas</h3>
          <div className="flex flex-wrap gap-3">
            <a href="/api-docs" className="rounded-xl border px-4 py-2 text-sm hover:bg-gray-50">API Docs</a>
            <a href="https://github.com" target="_blank" className="rounded-xl border px-4 py-2 text-sm hover:bg-gray-50">Repositorio</a>
          </div>
        </section>
      </div>
    </main>
  );
}
PAGE

# Script build:static en package.json de web
node -e "
const fs=require('fs');
const p='apps/web/package.json';
const j=JSON.parse(fs.readFileSync(p,'utf8'));
j.scripts=j.scripts||{};j.scripts.export='next export';j.scripts['build:static']='npm run build && npm run export';
fs.writeFileSync(p,JSON.stringify(j,null,2));
"

# ================= API (Express + Prisma + Zod) =================
mkdir -p apps/api/src apps/api/prisma

cat &gt; apps/api/package.json &lt;&lt;'APIPKG'
{
  "name": "api",
  "version": "0.1.0",
  "private": true,
  "scripts": {
    "dev": "ts-node-dev --respawn --transpile-only src/index.ts",
    "build": "tsc -p .",
    "start": "node dist/index.js",
    "prisma:generate": "prisma generate",
    "prisma:migrate": "prisma migrate dev --name init",
    "prisma:deploy": "prisma migrate deploy"
  },
  "dependencies": {
    "cors": "^2.8.5",
    "express": "^4.19.2",
    "zod": "^3.23.8",
    "@prisma/client": "^5.17.0"
  },
  "devDependencies": {
    "@types/express": "^4.17.21",
    "@types/node": "^20.12.7",
    "ts-node-dev": "^2.0.0",
    "typescript": "^5.4.0",
    "prisma": "^5.17.0"
  }
}
APIPKG

cat &gt; apps/api/tsconfig.json &lt;&lt;'TS'
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "CommonJS",
    "rootDir": "src",
    "outDir": "dist",
    "esModuleInterop": true,
    "strict": true,
    "skipLibCheck": true
  },
  "include": ["src"]
}
TS

cat &gt; apps/api/prisma/schema.prisma &lt;&lt;'PRISMA'
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Transaction {
  id        String   @id @default(cuid())
  type      String
  amount    Decimal  @db.Numeric(12,2)
  note      String?
  createdAt DateTime @default(now())
}
PRISMA

cat &gt; apps/api/src/index.ts &lt;&lt;'API'
import express from 'express';
import cors from 'cors';
import { PrismaClient } from '@prisma/client';
import { z } from 'zod';

const app = express();
const prisma = new PrismaClient();

app.use(cors());
app.use(express.json());

app.get('/health', (_req, res) => res.json({ ok: true }));

const TxSchema = z.object({
  type: z.enum(['INCOME', 'EXPENSE']).transform((v) => v.toString()),
  amount: z.number().positive(),
  note: z.string().optional()
});

app.get('/transactions', async (_req, res) => {
  const items = await prisma.transaction.findMany({ orderBy: { createdAt: 'desc' } });
  res.json(items);
});

app.post('/transactions', async (req, res) => {
  const parsed = TxSchema.safeParse(req.body);
  if (!parsed.success) return res.status(400).json(parsed.error);
  const { type, amount, note } = parsed.data;
  const tx = await prisma.transaction.create({ data: { type, amount, note } as any });
  res.status(201).json(tx);
});

app.delete('/transactions/:id', async (req, res) => {
  const { id } = req.params;
  await prisma.transaction.delete({ where: { id } });
  res.status(204).send();
});

const PORT = process.env.PORT || 4000;
app.listen(PORT, () => console.log(`API running on http://localhost:${PORT}`));
API

# ================= Infra (Docker) =================
mkdir -p infra/docker infra/db

cat &gt; infra/docker/docker-compose.dev.yml &lt;&lt;'DC'
version: "3.9"
services:
  db:
    image: postgres:16
    environment:
      POSTGRES_PASSWORD: postgres
      POSTGRES_USER: postgres
      POSTGRES_DB: bizflow
    ports: ["5432:5432"]
    volumes: ["postgres-data:/var/lib/postgresql/data"]
  api:
    build:
      context: ../../
      dockerfile: infra/docker/Dockerfile.api
    env_file:
      - ../../.env
    ports: ["4000:4000"]
    depends_on: [db]
  web:
    build:
      context: ../../
      dockerfile: infra/docker/Dockerfile.web
    env_file:
      - ../../.env
    ports: ["3000:3000"]
    depends_on: [api]
volumes:
  postgres-data:
DC

cat &gt; infra/docker/Dockerfile.api &lt;&lt;'DAPI'
FROM node:20-alpine
WORKDIR /app
COPY package.json pnpm-lock.yaml* ./
RUN corepack enable &amp;&amp; pnpm i --frozen-lockfile || pnpm i
COPY . .
ENV PORT=4000
EXPOSE 4000
CMD ["pnpm","--filter","apps/api","start"]
DAPI

cat &gt; infra/docker/Dockerfile.web &lt;&lt;'DWEB'
FROM node:20-alpine
WORKDIR /app
COPY package.json pnpm-lock.yaml* ./
RUN corepack enable &amp;&amp; pnpm i --frozen-lockfile || pnpm i
COPY . .
ENV PORT=3000
EXPOSE 3000
CMD ["pnpm","--filter","apps/web","dev","--port","3000"]
DWEB

# ================= GitHub Actions =================
cat &gt; .github/workflows/ci.yml &lt;&lt;'CI'
name: CI
on:
  pull_request:
  push:
    branches: [dev, main]

jobs:
  ci:
    runs-on: ubuntu-latest
    services:
      postgres:
        image: postgres:16
        env:
          POSTGRES_USER: postgres
          POSTGRES_PASSWORD: postgres
          POSTGRES_DB: bizflow
        ports: ["5432:5432"]
        options: >-
          --health-cmd="pg_isready -U postgres"
          --health-interval=10s
          --health-timeout=5s
          --health-retries=5
    env:
      DATABASE_URL: postgres://postgres:postgres@localhost:5432/bizflow
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: 'pnpm'
      - run: corepack enable
      - run: pnpm i --frozen-lockfile || pnpm i
      - name: Prisma generate
        run: pnpm --filter apps/api prisma:generate
      - name: Build API
        run: pnpm --filter apps/api build
      - name: Build Web
        run: pnpm --filter apps/web build
CI

# GitHub Pages (deploy web estática)
cat &gt; .github/workflows/pages.yml &lt;&lt;'PAGES'
name: Deploy Web to GitHub Pages

on:
  push:
    branches: [ main ]
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: true

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: 'pnpm'
      - run: corepack enable
      - run: pnpm i --frozen-lockfile || pnpm i
      - name: Build static web
        run: |
          pnpm --filter apps/web build:static
          mkdir -p ./build
          cp -R apps/web/out/* ./build/
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./build
  deploy:
    needs: build
    runs-on: ubuntu-latest
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
PAGES

# Publicación de imagen Docker para API (GHCR)
cat &gt; .github/workflows/docker-publish.yml &lt;&lt;'DP'
name: Publish Docker
on:
  push:
    branches: [main]
    tags: ["v*.*.*"]

jobs:
  docker:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      packages: write
    steps:
      - uses: actions/checkout@v4
      - name: Login GHCR
        uses: docker/login-action@v3
        with:
          registry: ghcr.io
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}
      - name: Build &amp; Push API
        uses: docker/build-push-action@v6
        with:
          context: .
          file: infra/docker/Dockerfile.api
          push: true
          tags: ghcr.io/${{ github.repository_owner }}/bizflow-api:latest
DP

# Deploy hook genérico
cat &gt; .github/workflows/deploy.yml &lt;&lt;'DEP'
name: Deploy
on:
  workflow_run:
    workflows: ["Publish Docker"]
    types: [completed]

jobs:
  deploy:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    runs-on: ubuntu-latest
    steps:
      - name: Trigger PaaS Deploy
        run: curl -X POST "${{ secrets.DEPLOY_HOOK_URL }}"
DEP

# Env ejemplo
cat &gt; .env.example &lt;&lt;'ENV'
DATABASE_URL=postgres://postgres:postgres@localhost:5432/bizflow
PORT=4000
ENV

# Git init
git init
if [ "${INIT_GIT}" = "true" ]; then
  git add .
  git commit -m "chore: initial scaffold (BizFlow)"
  git branch -M "${DEFAULT_BRANCH}"
fi

# Crear repo remoto (opcional)
if [ "${CREATE_REMOTE}" = "true" ]; then
  command -v gh &gt;/dev/null || { echo "[WARN] gh no está instalado; omitiendo repo remoto"; exit 0; }
  gh repo create "${GITHUB_USER}/${REPO_NAME}" --public --source=. --remote=origin
  git push -u origin "${DEFAULT_BRANCH}"
fi

echo "\n✅ Listo. Siguientes pasos:";
echo "1) cp .env.example .env y ajusta DATABASE_URL";
echo "2) pnpm i &amp;&amp; pnpm --filter apps/api prisma:generate &amp;&amp; pnpm --filter apps/api prisma:migrate";
echo "3) pnpm dev (API:4000, Web:3000)";
echo "4) En GitHub, Settings → Pages → GitHub Actions (para pages.yml)";
echo "5) (Opcional) Configura secret DEPLOY_HOOK_URL para tu PaaS";
</code></pre>
    </div>

    <div class="card">
      <h2>3) Notas útiles</h2>
      <ul>
        <li>Para Pages, la web se publica bajo <code>/bizflow</code>. La URL será <code>https://eliezelapolinaris2017-lab.github.io/bizflow</code>.</li>
        <li>Si quieres crear el repo remoto automáticamente, cambia <code>CREATE_REMOTE</code> a <code>true</code> y ten instalado <code>gh</code>.</li>
        <li>Para documentar y redactar whitepapers rápidamente puedes usar <a href="https://jenni.ai/?via=lekys">Jenni AI</a>.</li>
      </ul>
    </div>
  </div>
</body>
</html>
